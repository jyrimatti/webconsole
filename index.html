<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Programming language Web Console</title>
	<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
	<script src="http://coffeescript.org/extras/coffee-script.js"></script>
	<script type="text/coffeescript">
		$(document).ready ->
			$('.box').click -> $(this).unbind('click').children().slideDown()
			$('.box h2').click -> $(this).siblings().slideToggle()
			
			$('.layout .vertical').click -> $('body').removeClass('horizontal').addClass('vertical')
			$('.layout .horizontal').click -> $('body').removeClass('vertical').addClass('horizontal')
			
			queryString = decodeURIComponent location.search.replace(/^\?/, '')
			libs = (qs for qs in queryString.split(/\s+/) when qs isnt '')
			$(libs).each -> $('head').append("<" + "script src='#{this}'><" + "/script>")
			
			$('.links a').each ->
				href = $(this).attr('href')
				if window.location.search.indexOf(href) == -1
					$(this).attr('href', "?#{queryString} #{href}")
				else
					$(this).remove()

			$('.links').each -> $(this).remove() if $('a', this).length == 0

			$('.included').each ->
				included = $(this)
				$(libs).each -> included.append('<' + 'div title="' + this + '">' + this + '<' + '/div>')
				
			$('input').focus ->
				$(this).val ''
			$('input.include').keyup (e) -> if e.which == 13
				href = $(this).val()
				if window.location.search != ''
					window.location.search = href
				else
					window.location.search = window.location.search + ' ' + href
					
			$('.showCompiled input').change (e) ->
				checked = $(this).is(':checked')
				window.copyCompiled = checked
				$('.javascript h2').siblings().slideDown() if checked
				
	</script>
	<script type="text/coffeescript">
		# Shamelessly copied from coffeescript.org	

    compileSource = ->
      source = $('.coffeescript textarea').val()
      window.compiledCJS = ''
      try
        window.compiledCJS = CoffeeScript.compile source, bare: on
        $('.coffeescript .error').hide()
        $('.javascript textarea').val(window.compiledCJS) if window.copyCompiled
      catch error
        $('.coffeescript .error').text(error.message).show()
        $('.javascript textarea').val('') if window.copyCompiled

    $('.coffeescript textarea').keyup -> compileSource()

    evalCJS = ->
      try
        eval window.compiledCJS
      catch error then alert error

    window.loadConsole = (coffee) ->
      $('.coffeescript textarea').val coffee
      compileSource()
      false

    $('.coffeescript textarea')
      .keydown (e) -> 
        evalCJS() if e.which == 13
    
    loadConsole decodeURIComponent location.hash.replace(/^#/, '')
		
    compileSource()	
	</script>
	
	<script type="text/coffeescript">
    compileSource = ->
      source = $('.javascript textarea').val()
      window.compiledJS = ''
      try
        window.compiledJS = source
        $('.javascript .error').hide()
      catch error
        $('.javascript .error').text(error.message).show()

    $('.javascript textarea').keyup -> compileSource()

    evalJS = ->
      try
        eval window.compiledJS
      catch error then alert error

    window.loadConsole = (js) ->
      $('.javascript textarea').val js
      compileSource()
      false

    $('.javascript textarea')
      .keydown (e) -> 
        evalJS() if e.which == 13
    
    loadConsole decodeURIComponent location.hash.replace(/^#/, '')
		
    compileSource()	
	</script>
	
	<link href='http://fonts.googleapis.com/css?family=Exo' rel='stylesheet' type='text/css' />
	<style type="text/css">
		body {
			font-family: 'Exo', sans-serif;
		}
		h1 {
			text-shadow: 0px 0px rgba(0,0,0,0.15), 
             			 0px 3px rgba(0,0,0,0.15), 
             			 3px 0px rgba(0,0,0,0.15), 
             			 0px 0px rgba(0,0,0,0.15);
      font-style: italic;
      color: #666666;
      margin: 0;
		}
		h2, h6 {
			margin: 0;
			font-weight: normal;
		}
		h2 {
			font-size: 1em;
			float: left;
			padding-right: 2em;
		}
		h6 {
			font-size: 0.7em;
		}
		a, a:visited {
			color: black;
			text-decoration: none;
		}
		a:hover {
			font-weight: bold;
		}
		input[type='text'] {
			color: inherit;
			font-size: 0.5em;
			border: 1px dotted;
			border-radius: 0.5em;
			border-color: inherit;
			background: transparent;
			width: 15em;
			text-align: right;
			margin-top: 1px;
		}
		input:hover {
			border-style: solid;
		}
		textarea {
			height: 200px;
			width: 100%;
		}
		.layout {
			float: right;
			text-align: right;
		}
		.layout div:hover {
			font-weight: bold;
		}
		.box {
			margin: 0.5em;
			padding: 0.25em 0.5em;
			
			border: 1px solid #FF0000;
			border-radius: 0.25em;
			background-color: #11FFFF;
			
			font-size: 2em;
			overflow: hidden;
		}
		.horizontal .box {
			width: 44%;
			float: left;
		}
		.error {
			color: Red;
			font-size: 0.5em;
		}
		.content {
			display: none;
			margin-top: 0.2em;
			position: relative;
			clear: both;
		}
		.links {
			display: none;
			float: right;
			font-size: 0.4em;
			text-align: right;
		}
		.links a {
			display: block;
		}
		.included {
			float: left;
			font-size: 0.4em;
			padding-right: 2em;
		}
		.disclaimer {
			position: absolute;
			right: 0;
			bottom: 0;
			color: LightGray;
			font-size: 0.1em;
		}
		.showCompiled {
			display: none;
			font-size: 0.2em;
		}
		.scala {
			color: #052C6E;
			border-color: #052C6E;
			background-color: #6A92D4;
		}
		.jruby {
			color: #A60000;
			border-color: #A60000;
			background-color: #FF7373;
		}
		.coffeescript {
			color: #00675C;
			border-color: #00675C;
			background-color: #5DCFC3;
		}
		.javascript {
			color: #A68F20;
			border-color: #A68F20;
			background-color: #FFF0A8;
		}
	</style>
</head>
<body>
	<div class="layout">
		<div class="vertical">vertical</div>
		<div class="horizontal">horizontal</div>
	</div>
	
	<h1><a href="?">Programming languages WebConsole</a></h1>
	
	<div class="box scala">
		<h2>Scala</h2>
		<div class="content">
			<applet code="net.lahteenmaki.webconsole.ScalaWebConsole.class"
				archive="static/WebConsole-0.1-SNAPSHOT.jar"
				codebase="/"
				width="100%" 
				height="200">
				<param name="scalaVersion" value="2.9.1" />
			</applet>
		</div>
	</div>

	<div class="box jruby">
		<h2>JRuby</h2>
		<div class="content">
			<applet code="net.lahteenmaki.webconsole.JRubyWebConsole.class"
				archive="static/WebConsole-0.1-SNAPSHOT.jar,static/jruby-complete-signed.jar"
				codebase="/"
				width="100%" 
				height="200">
			</applet>
			<div class="disclaimer">code mostly copied from org.jruby.demo.IRBConsole</div>
		</div>
	</div>
	
	<div class="box coffeescript">
		<h2>CoffeeScript</h2>
		<div class="links">
			<h6>include:</h6>
			<a href="http://underscorejs.org/underscore-min.js">Underscore.js</a>
			<a href="https://raw.github.com/leonidas/transparency/master/lib/transparency.min.js">Transparency</a>
			<input class="include" type="text" value="type .js URL here and hit enter" />
		</div>
		<div class="included">
			<h6>included:</h6>
			<div>http://code.jquery.com/jquery.min.js</div>
		</div>
		<div style="clear: both"></div>
		<div class="content">
			<div class="error"></div>
			<textarea></textarea>
			<div class="disclaimer">interpreter shamelessly copied from coffeescript.org</div>
		</div>
		<div class="showCompiled">
			<input id="showCompiled" type="checkbox" />
			<label for="showCompiled">show compiled source in JavaScript box</label>
		</div>
	</div>
	
	<div class="box javascript">
		<h2>JavaScript</h2>		
		<div class="links">
			<h6>include:</h6>
			<a href="http://underscorejs.org/underscore-min.js">Underscore.js</a>
			<a href="https://raw.github.com/leonidas/transparency/master/lib/transparency.min.js">Transparency</a>
			<input class="include" type="text" value="type .js URL here and hit enter" />
		</div>
		<div class="included">
			<h6>included:</h6>
			<div>http://code.jquery.com/jquery.min.js</div>
		</div>
		<div style="clear: both"></div>
		<div class="content" style="position: relative">
			<div class="error"></div>
			<textarea></textarea>
		</div>
	</div>
</body>
</html>